<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>SAM Doc : Update-11</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            SAM Doc : Update-11
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jul 05, 2011 by <font color="#0050B2">wlapka</font>.
				    </div>

				    <h1><a name="Update-11-Release%3A"></a>Release: Update-11</h1>

<h2><a name="Update-11-Summary"></a>Summary</h2>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> Start Date </td>
<td class='confluenceTd'> 11 Apr 2011 <br class="atl-forced-newline" /> </td>
</tr>
<tr>
<td class='confluenceTd'> End Date </td>
<td class='confluenceTd'> 17 May 2011 </td>
</tr>
<tr>
<td class='confluenceTd'> Status </td>
<td class='confluenceTd'> <font color="#ff0000">Released</font><br class="atl-forced-newline" /> </td>
</tr>
<tr>
<td class='confluenceTd'> Release Date </td>
<td class='confluenceTd'> 22 June 2011 <br class="atl-forced-newline" /> </td>
</tr>
<tr>
<td class='confluenceTd'> Release Manager </td>
<td class='confluenceTd'> Wojciech Lapka <br class="atl-forced-newline" /> </td>
</tr>
</tbody></table>
</div>


<h2><a name="Update-11-ValidationStepsperformed"></a>Validation Steps performed</h2>

<ul>
	<li>Outlined in <a href="https://tomtools.cern.ch/jira/browse/SAM-1491">SAM-1491</a></li>
	<li>Announced for Stage Rollout - 17 May 2011 (Update 11), 14 June 2011 (Update 11.1)</li>
	<li>Cleared staged rollout &#45;&nbsp;22 June 2011
	<ul>
		<li>Early Adopter Report - <a href="https://documents.egi.eu/document/584">SAM-Update-11-EA-Report</a></li>
	</ul>
	</li>
</ul>


<h2><a name="Update-11-Listofnewmetrics"></a>List of new metrics</h2>

<p>CE:</p>
<ul>
	<li>hr.srce.GRAM-Auth - <a href="http://wiki.cro-ngi.hr/en/index.php/Hr.srce.GRAM-Auth">more info</a></li>
	<li>org.nagios.GridFTP-Check - <a href="http://nagiosplugins.org/man/check_ftp">more info</a></li>
</ul>


<p>CREAMCE:</p>
<ul>
	<li>org.sam.CREAMCE-DirectJobState <img class="emoticon" src="images/icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> &#45; <a href="https://tomtools.cern.ch/confluence/display/SAM/CREAMCE+DJS">more info</a></li>
	<li>org.sam.CREAMCE-DirectJobSubmit - <a href="https://tomtools.cern.ch/confluence/display/SAM/CREAMCE+DJS">more info</a></li>
</ul>


<p>LB:</p>
<ul>
	<li>hr.srce.LB-CertLifetime - <a href="http://wiki.cro-ngi.hr/en/index.php/Hr.srce.CertLifetime">more info</a></li>
</ul>


<p>MyProxy:</p>
<ul>
	<li>hr.srce.MyProxy-Store - <a href="http://wiki.cro-ngi.hr/en/index.php/Hr.srce.MyProxy-Store">more info</a></li>
</ul>


<p>Top-BDII &amp; Site-BDII:</p>
<ul>
	<li>org.nagios.BDII-Check - <a href="http://nagiosplugins.org/man/check_ldap">more info</a></li>
</ul>


<p>WMS:</p>
<ul>
	<li>org.nagios.GridFTP-Check - <a href="http://nagiosplugins.org/man/check_ftp">more info</a></li>
	<li>org.sam.WMS-JobState <img class="emoticon" src="images/icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> &#45; <a href="https://tomtools.cern.ch/confluence/display/SAM/WMS">more info</a></li>
	<li>org.sam.WMS-JobSubmit - <a href="https://tomtools.cern.ch/confluence/display/SAM/WMS">more info</a></li>
</ul>


<p>Nagios:</p>
<ul>
	<li>hr.srce.GoodCEs <img class="emoticon" src="images/icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/><img class="emoticon" src="images/icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> &#45; <a href="https://tomtools.cern.ch/confluence/display/SAM/WMS">more info</a></li>
</ul>


<p>GRAM5:</p>
<ul>
	<li>hr.srce.GRAM-Auth - <a href="http://wiki.cro-ngi.hr/en/index.php/Hr.srce.GRAM-Auth">more info</a></li>
	<li>hr.srce.GRAM-CertLifetime - <a href="http://wiki.cro-ngi.hr/en/index.php/Hr.srce.CertLifetime">more info</a></li>
	<li>hr.srce.GRAM-Command&#45; <a href="http://wiki.cro-ngi.hr/en/index.php/Hr.srce.GRAM-Command">more info</a></li>
	<li>hr.srce.GridFTP-Transfer - <a href="http://wiki.cro-ngi.hr/en/index.php/Hr.srce.GridFTP-Transfer">more info</a></li>
	<li>org.nagios.GridFTP-Check - <a href="http://nagiosplugins.org/man/check_ftp">more info</a></li>
</ul>


<p>globus-GRIDFTP:</p>
<ul>
	<li>hr.srce.GridFTP-Transfer - <a href="http://wiki.cro-ngi.hr/en/index.php/Hr.srce.GridFTP-Transfer">more info</a></li>
	<li>org.nagios.GridFTP-Check - <a href="http://nagiosplugins.org/man/check_ftp">more info</a></li>
</ul>


<p>globus-GSISSHD:</p>
<ul>
	<li>org.nagios.gsissh-Check - <a href="http://nagiosplugins.org/man/check_ssh">more info</a></li>
</ul>


<p><img class="emoticon" src="images/icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> &#45; internal checks which are not propagated to MyEGI<br/>
<img class="emoticon" src="images/icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/><img class="emoticon" src="images/icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> &#45; check will only appear if Nagios is monitoring WMS services</p>

<h2><a name="Update-11-Listofpackagesupdatedinthisrelease"></a>List of packages updated in this release</h2>


<h4><a name="Update-11-NodeegeeNAGIOS"></a>Node egee-NAGIOS</h4>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>egee-NAGIOS-1.0.0-61.el5
atp-1.16.10-2.el5
atp-web-1.16.10-2.el5
glite-yaim-nagios-1.4.3-3.el5
grid-monitoring-config-gen-0.79.1-1.el5
grid-monitoring-probes-cadist-0.3.0-1.el5
grid-monitoring-probes-org.sam-0.1.20-2.el5
grid-monitoring-probes-org.sam.sec-0.3.1-1.el5
myegi-0.5.5-1.el5
nagios2metricstore-1.0.34-2.el5
nagios-gocdb-downtime-0.24.1-1.el5
sam-release-1.11.0-1.el5
</pre>
</div></div>

<h4><a name="Update-11-NodeegeeNAGIOSWEB"></a>Node egee-NAGIOS-WEB</h4>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>egee-NAGIOS-WEB-0.9.0-5.el5
ace-0.1.6-2.el5
atp-1.16.10-2.el5
atp-web-1.16.10-2.el5
glite-yaim-nagios-1.4.3-3.el5
myegi-0.5.5-1.el5
nagios2metricstore-1.0.34-2.el5
poem-0.3-1.el5
sam-release-1.11.0-1.el5
</pre>
</div></div>

<h2><a name="Update-11-ReleaseNotes"></a>Release Notes</h2>

<ul>
	<li>/etc/atp/atp_synchro.conf is created by YAIM.</li>
	<li>Added tests for Globus5 service:
	<ul>
		<li>GRAM5</li>
		<li>globus-GRIDFTP</li>
		<li>globus-GSISSHD</li>
	</ul>
	</li>
	<li>Support for uncertified sites running CREAM-CE</li>
	<li>Removed metric org.ggus.Tickets</li>
	<li>MyEGI web services - bug fixes</li>
	<li>ACE - recomputation of availabilities when data received with a delay</li>
	<li>ACE/ATP/MRS - bug fixes</li>
	<li>Change of help URLs for "org.sam.*" probes</li>
</ul>


<h2><a name="Update-11-Configurationchanges"></a>Configuration changes</h2>

<ul>
	<li>New YAIM configuration variables
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: java; gutter: false"># switch host checks off/on (see SAM-1173) (optional variable)
NCG_CHECK_HOSTS=1

# change GOCDB root URL (see SAM-1419) (optional variable)
GOCDB_ROOT_URL=https://goc.egi.eu/gocdbpi/

# if LDAP topology is used, control adding hosts (see SAM-1470) (optional variable)
NCG_LDAP_ADD_HOSTS=1

# switch off importing admin DNs (see SAM-1434) (optional variable)
NCG_CONTACTS_USE_GOCDB=false</pre>
</div></div></li>
</ul>


<ul>
	<li>Removed Yaim variable
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: java; gutter: false">ROC_NAME=...
# use NCG_GOCDB_ROC_NAME instead</pre>
</div></div></li>
</ul>


<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>Note that after upgrade and before YAIM execution, glite-info-service-nagios.conf.rpmnew configuration file should replace the existing one, i.e.
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: java; gutter: false">mv /opt/glite/etc/glite-info-service-nagios.conf.rpmnew /opt/glite/etc/glite-info-service-nagios.conf</pre>
</div></div>

<p>If the .rpmnew file doesn't exist make sure that file contains the following line:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>get_data = echo -e "Role=${NAGIOS_ROLE}\nMsgNagiosDestination="$(. /etc/sysconfig/msg-to-queue &amp;&amp; echo $MSG_TO_QUEUE_DESTINATION)"\nVersion="$(cat /etc/sam-release)
</pre>
</div></div></td></tr></table></div>

<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>Globus services currently do not support VOs. In order to monitor Globus services SAM administrator has to contact <b>all sites</b> and request to add the certificate DN to the grid-mapfile.</td></tr></table></div>

<h2><a name="Update-11-KnownIssues"></a>Known Issues</h2>

<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>For machines running latest version of glite-UI (3.2.10-1):

<p>Please restart Nagios after yaim execution. Otherwise you may see problems similar to <a href="https://tomtools.cern.ch/jira/browse/SAM-1693">SAM-1693</a>.</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: java; gutter: false">service nagios restart</pre>
</div></div></td></tr></table></div>

<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>In new installations please add following line to file /etc/my.cnf and restart mysql:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: java; gutter: false">[mysqld]
event-scheduler=1</pre>
</div></div></td></tr></table></div>

<p>If the monitoring infrastructure contains <b>WMS</b> service and no <b>CE</b> services, metric <b>hr.srce.GoodCEs</b> associated to Nagios service will fail with the following error:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: java; gutter: false">HealthyNodes CRITICAL - No healthy hosts found.</pre>
</div></div>
<p>In order to fix it create file /etc/ncg/ncg-localdb.d/GoodCEs-fix with the following content:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: java; gutter: false">MODIFY_METRIC_PARAMETER!hr.srce.GoodCEs!--metric!org.sam.CREAMCE-JobSubmit</pre>
</div></div>
<p>and restart service ncg:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: java; gutter: false">service ncg restart</pre>
</div></div>

<h2><a name="Update-11-ListofIssuesfixedinthisrelease"></a>List of Issues fixed in this release</h2>

<div class="error"><span class="error">jiraissues: Unable to determine if sort should be enabled.</span> </div>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="https://tomtools.cern.ch/confluence/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Feb 27, 2014 10:19</font></td>
		    </tr>
	    </table>
    </body>
</html>
